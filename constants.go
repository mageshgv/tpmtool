package main

import (
	"github.com/google/go-tpm/tpm2"
)

// Algorithm constants.
const (
	TPM2_ALG_ERROR          = 0x0000
	TPM2_ALG_RSA            = 0x0001
	TPM2_ALG_TDES           = 0x0003
	TPM2_ALG_SHA1           = 0x0004
	TPM2_ALG_HMAC           = 0x0005
	TPM2_ALG_AES            = 0x0006
	TPM2_ALG_MGF1           = 0x0007
	TPM2_ALG_KEYEDHASH      = 0x0008
	TPM2_ALG_XOR            = 0x000a
	TPM2_ALG_SHA256         = 0x000b
	TPM2_ALG_SHA384         = 0x000c
	TPM2_ALG_SHA512         = 0x000d
	TPM2_ALG_NULL           = 0x0010
	TPM2_ALG_SM3_256        = 0x0012
	TPM2_ALG_SM4            = 0x0013
	TPM2_ALG_RSASSA         = 0x0014
	TPM2_ALG_RSAES          = 0x0015
	TPM2_ALG_RSAPSS         = 0x0016
	TPM2_ALG_OAEP           = 0x0017
	TPM2_ALG_ECDSA          = 0x0018
	TPM2_ALG_ECDH           = 0x0019
	TPM2_ALG_ECDAA          = 0x001a
	TPM2_ALG_SM2            = 0x001b
	TPM2_ALG_ECSCHNORR      = 0x001c
	TPM2_ALG_ECMQV          = 0x001d
	TPM2_ALG_KDF1_SP800_56A = 0x0020
	TPM2_ALG_KDF2           = 0x0021
	TPM2_ALG_KDF1_SP800_108 = 0x0022
	TPM2_ALG_ECC            = 0x0023
	TPM2_ALG_SYMCIPHER      = 0x0025
	TPM2_ALG_CAMELLIA       = 0x0026
	TPM2_ALG_SHA3_256       = 0x0027
	TPM2_ALG_SHA3_384       = 0x0028
	TPM2_ALG_SHA3_512       = 0x0029
	TPM2_ALG_CMAC           = 0x003f
	TPM2_ALG_CTR            = 0x0040
	TPM2_ALG_OFB            = 0x0041
	TPM2_ALG_CBC            = 0x0042
	TPM2_ALG_CFB            = 0x0043
	TPM2_ALG_ECB            = 0x0044
)

// Algorithm property constants.
const (
	TPMA_ALGORITHM_ASYMMETRIC = 0x0001
	TPMA_ALGORITHM_SYMMETRIC  = 0x0002
	TPMA_ALGORITHM_HASH       = 0x0004
	TPMA_ALGORITHM_OBJECT     = 0x0008
	TPMA_ALGORITHM_SIGNING    = 0x0100
	TPMA_ALGORITHM_ENCRYPTING = 0x0200
	TPMA_ALGORITHM_METHOD     = 0x0400
)

// Handle type constants.
const (
	TPM2_HT_PCR            = 0x00
	TPM2_HT_NV_INDEX       = 0x01
	TPM2_HT_HMAC_SESSION   = 0x02
	TPM2_HT_LOADED_SESSION = 0x02
	TPM2_HT_POLICY_SESSION = 0x03
	TPM2_HT_SAVED_SESSION  = 0x03
	TPM2_HT_PERMANENT      = 0x40
	TPM2_HT_TRANSIENT      = 0x80
	TPM2_HT_PERSISTENT     = 0x81
)

// Capability constants.
const (
	TPM2_CAP_FIRST           = 0x00000000
	TPM2_CAP_ALGS            = 0x00000000
	TPM2_CAP_HANDLES         = 0x00000001
	TPM2_CAP_COMMANDS        = 0x00000002
	TPM2_CAP_PP_COMMANDS     = 0x00000003
	TPM2_CAP_AUDIT_COMMANDS  = 0x00000004
	TPM2_CAP_PCRS            = 0x00000005
	TPM2_CAP_TPM_PROPERTIES  = 0x00000006
	TPM2_CAP_PCR_PROPERTIES  = 0x00000007
	TPM2_CAP_ECC_CURVES      = 0x00000008
	TPM2_CAP_LAST            = 0x00000008
	TPM2_CAP_VENDOR_PROPERTY = 0x00000100
)

var algToString = map[tpm2.Algorithm]string{
	TPM2_ALG_ERROR:          "TPM2_ALG_ERROR",
	TPM2_ALG_RSA:            "TPM2_ALG_RSA",
	TPM2_ALG_TDES:           "TPM2_ALG_TDES",
	TPM2_ALG_SHA1:           "TPM2_ALG_SHA1",
	TPM2_ALG_HMAC:           "TPM2_ALG_HMAC",
	TPM2_ALG_AES:            "TPM2_ALG_AES",
	TPM2_ALG_MGF1:           "TPM2_ALG_MGF1",
	TPM2_ALG_KEYEDHASH:      "TPM2_ALG_KEYEDHASH",
	TPM2_ALG_XOR:            "TPM2_ALG_XOR",
	TPM2_ALG_SHA256:         "TPM2_ALG_SHA256",
	TPM2_ALG_SHA384:         "TPM2_ALG_SHA384",
	TPM2_ALG_SHA512:         "TPM2_ALG_SHA512",
	TPM2_ALG_NULL:           "TPM2_ALG_NULL",
	TPM2_ALG_SM3_256:        "TPM2_ALG_SM3_256",
	TPM2_ALG_SM4:            "TPM2_ALG_SM4",
	TPM2_ALG_RSASSA:         "TPM2_ALG_RSASSA",
	TPM2_ALG_RSAES:          "TPM2_ALG_RSAES",
	TPM2_ALG_RSAPSS:         "TPM2_ALG_RSAPSS",
	TPM2_ALG_OAEP:           "TPM2_ALG_OAEP",
	TPM2_ALG_ECDSA:          "TPM2_ALG_ECDSA",
	TPM2_ALG_ECDH:           "TPM2_ALG_ECDH",
	TPM2_ALG_ECDAA:          "TPM2_ALG_ECDAA",
	TPM2_ALG_SM2:            "TPM2_ALG_SM2",
	TPM2_ALG_ECSCHNORR:      "TPM2_ALG_ECSCHNORR",
	TPM2_ALG_ECMQV:          "TPM2_ALG_ECMQV",
	TPM2_ALG_KDF1_SP800_56A: "TPM2_ALG_KDF1_SP800_56A",
	TPM2_ALG_KDF2:           "TPM2_ALG_KDF2",
	TPM2_ALG_KDF1_SP800_108: "TPM2_ALG_KDF1_SP800_108",
	TPM2_ALG_ECC:            "TPM2_ALG_ECC",
	TPM2_ALG_SYMCIPHER:      "TPM2_ALG_SYMCIPHER",
	TPM2_ALG_CAMELLIA:       "TPM2_ALG_CAMELLIA",
	TPM2_ALG_SHA3_256:       "TPM2_ALG_SHA3_256",
	TPM2_ALG_SHA3_384:       "TPM2_ALG_SHA3_384",
	TPM2_ALG_SHA3_512:       "TPM2_ALG_SHA3_512",
	TPM2_ALG_CMAC:           "TPM2_ALG_CMAC",
	TPM2_ALG_CTR:            "TPM2_ALG_CTR",
	TPM2_ALG_OFB:            "TPM2_ALG_OFB",
	TPM2_ALG_CBC:            "TPM2_ALG_CBC",
	TPM2_ALG_CFB:            "TPM2_ALG_CFB",
	TPM2_ALG_ECB:            "TPM2_ALG_ECB",
}

var algPropToString = map[tpm2.AlgorithmAttributes]string{
	TPMA_ALGORITHM_ASYMMETRIC: "TPMA_ALGORITHM_ASYMMETRIC",
	TPMA_ALGORITHM_SYMMETRIC:  "TPMA_ALGORITHM_SYMMETRIC",
	TPMA_ALGORITHM_HASH:       "TPMA_ALGORITHM_HASH",
	TPMA_ALGORITHM_OBJECT:     "TPMA_ALGORITHM_OBJECT",
	TPMA_ALGORITHM_SIGNING:    "TPMA_ALGORITHM_SIGNING",
	TPMA_ALGORITHM_ENCRYPTING: "TPMA_ALGORITHM_ENCRYPTING",
	TPMA_ALGORITHM_METHOD:     "TPMA_ALGORITHM_METHOD",
}

var capToString = map[uint32]string{
	TPM2_CAP_ALGS:            "TPM2_CAP_ALGS",
	TPM2_CAP_HANDLES:         "TPM2_CAP_HANDLES",
	TPM2_CAP_COMMANDS:        "TPM2_CAP_COMMANDS",
	TPM2_CAP_PP_COMMANDS:     "TPM2_CAP_PP_COMMANDS",
	TPM2_CAP_AUDIT_COMMANDS:  "TPM2_CAP_AUDIT_COMMANDS",
	TPM2_CAP_PCRS:            "TPM2_CAP_PCRS",
	TPM2_CAP_TPM_PROPERTIES:  "TPM2_CAP_TPM_PROPERTIES",
	TPM2_CAP_PCR_PROPERTIES:  "TPM2_CAP_PCR_PROPERTIES",
	TPM2_CAP_ECC_CURVES:      "TPM2_CAP_ECC_CURVES",
	TPM2_CAP_VENDOR_PROPERTY: "TPM2_CAP_VENDOR_PROPERTY",
}

var handleTypeToString = map[uint32]string{
	TPM2_HT_PCR:            "TPM2_HT_PCR",
	TPM2_HT_NV_INDEX:       "TPM2_HT_NV_INDEX",
	TPM2_HT_HMAC_SESSION:   "TPM2_HT_HMAC_SESSION",
	TPM2_HT_POLICY_SESSION: "TPM2_HT_POLICY_SESSION",
	TPM2_HT_PERMANENT:      "TPM2_HT_PERMANENT",
	TPM2_HT_TRANSIENT:      "TPM2_HT_TRANSIENT",
	TPM2_HT_PERSISTENT:     "TPM2_HT_PERSISTENT",
}
